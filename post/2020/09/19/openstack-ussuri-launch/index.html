<!doctype html><html lang=ja-jp><head><meta charset=utf-8><link crossorigin=anonymous media=all rel=stylesheet href=https://aton-kish.github.io/blog/css/frameworks.css><link crossorigin=anonymous media=all rel=stylesheet href=https://aton-kish.github.io/blog/css/github.css><link crossorigin=anonymous media=all rel=stylesheet href=https://aton-kish.github.io/blog/css/custom.css><link crossorigin=anonymous media="(prefers-color-scheme: dark)" rel=stylesheet href=https://aton-kish.github.io/blog/css/dark.css><meta name=viewport content="width=device-width"><meta name=description content="OpenStack UssuriをUbuntu 20.04 LTSにマニュアルインストールその９―起動編"><meta name=keywords content="OpenStack,Ussuri,Ubuntu"><meta name=robots content="noodp"><link rel=canonical href=https://aton-kish.github.io/blog/post/2020/09/19/openstack-ussuri-launch/><meta name=twitter:card content="summary"><meta name=twitter:title content="OpenStack Ussuriマニュアルインストールその９―起動編 - Nota"><meta name=twitter:description content="OpenStack UssuriをUbuntu 20.04 LTSにマニュアルインストールその９―起動編"><meta name=twitter:site content="https://aton-kish.github.io/blog/"><meta name=twitter:creator content><meta name=twitter:image content="https://aton-kish.github.io/blog/"><meta property="og:type" content="article"><meta property="og:title" content="OpenStack Ussuriマニュアルインストールその９―起動編 - Nota"><meta property="og:description" content="OpenStack UssuriをUbuntu 20.04 LTSにマニュアルインストールその９―起動編"><meta property="og:url" content="https://aton-kish.github.io/blog/post/2020/09/19/openstack-ussuri-launch/"><meta property="og:site_name" content="OpenStack Ussuriマニュアルインストールその９―起動編"><meta property="og:image" content="https://aton-kish.github.io/blog/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-09-19 22:24:37 +0900 +0900"><title>OpenStack Ussuriマニュアルインストールその９―起動編 | Nota</title><link rel=apple-touch-icon sizes=180x180 href=https://aton-kish.github.io/blog/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://aton-kish.github.io/blog/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://aton-kish.github.io/blog/favicon-16x16.png><link rel=manifest href=https://aton-kish.github.io/blog/site.webmanifest><link rel=mask-icon href=https://aton-kish.github.io/blog/safari-pinned-tab.svg color=#000000><link rel="shortcut icon" href=https://aton-kish.github.io/blog/favicon.ico><meta name=msapplication-TileColor content="#000000"><meta name=msapplication-config content="https://aton-kish.github.io/blog/browserconfig.xml"><meta name=theme-color content="#ffffff"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-177653883-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-177653883-1');</script></head><body class="env-production emoji-size-boost page-responsive page-profile"><div class="position-relative js-header-wrapper"><span class="Progress progress-pjax-loader position-fixed width-full js-pjax-loader-bar"><span class="progress-pjax-loader-bar top-0 left-0" style=width:0%></span></span><header class="Header py-lg-0 js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role=banner><div class="Header-item d-none d-lg-flex"><a class=Header-link href=https://aton-kish.github.io/blog/ aria-label=Homepage data-ga-click="Header, go to dashboard, icon:logo"><svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div><div class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden"><div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to" role=combobox aria-owns=jump-to-results aria-label="Search or jump to" aria-haspopup=listbox aria-expanded=false><div class=position-relative></div></div></div><nav class=d-flex aria-label=Global><a class="js-selected-navigation-item Header-link py-lg-3">&nbsp;</a></nav><div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative" style=margin-right:auto><a class=Header-link href=https://aton-kish.github.io/blog/ aria-label=Homepage data-ga-click="Header, go to dashboard, icon:logo"><svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div><div class="Header-item position-relative mr-0 d-none d-lg-flex"><details class="details-overlay details-reset"><summary class=Header-link aria-label="View profile and more" data-ga-click="Header, show menu, icon:avatar"><img alt class="avatar avatar-user" src=https://aton-kish.github.io/blog/images/avatar.png height=20 width=20></summary></details></div></header></div><div id=start-of-content class=show-on-focus></div><div id=js-flash-container></div><div class=application-main data-commit-hovercards-enabled><div itemscope itemtype=http://schema.org/SoftwareSourceCode><main><div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4"><div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block"><div class="mb-3 d-flex"><h1 class="public css-truncate float-none flex-auto width-fit pl-0"><a class="avatar mr-1" href=https://aton-kish.github.io/blog/about/><img class=avatar-user src=https://aton-kish.github.io/blog/images/avatar.png width=26 height=26></a>
<span class=author><a href=https://aton-kish.github.io/blog/>Aton-Kish</a></span>
<span class=path-divider>/</span>
<strong itemprop=name class=css-truncate-target style=max-width:410px><a href=https://aton-kish.github.io/blog/post/2020/09/19/openstack-ussuri-launch/>OpenStack Ussuriマニュアルインストールその９―起動編</a></strong><div class="d-block text-small text-gray">Created <time-ago datetime="2020/09/19 22:24:37" class=no-wrap title="Created at 2020/09/19 22:24:37">2020-09-19 22:24:37</time-ago>
<span class=file-info-divider></span>Modified <time-ago datetime="2021/03/15 17:08:27" class=no-wrap title="Modified  at 2021/03/15 17:08:27">2021-03-15</time-ago></div></h1></div></div></div><div class="container-lg clearfix new-discussion-timeline experiment-repo-nav p-responsive"><div class=repository-content><div class="Box mt-3 position-relative"><div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center"><div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">4664 Words</div></div><div id=readme class="Box-body readme blob instapaper_body js-code-block-container"><article class="markdown-body entry-content p-3 p-md-6" itemprop=text><h1 id=openstack-ussuri-マニュアルインストールその９起動編>OpenStack Ussuri マニュアルインストールその９―起動編</h1><p><span class=label style=background-color:#053260>Controller</span></p><ul><li><del>Horizon ダッシュボードからポチポチやってもできるしわかりやすい気がする</del></li></ul><h2 id=ネットワーク作成>ネットワーク作成</h2><h3 id=プロバイダネットワーク>プロバイダネットワーク</h3><p><a href=https://docs.openstack.org/install-guide/launch-instance-networks-provider.html#create-the-provider-network><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Provider network - Create the provider network</a></p><ol><li><p><code>admin</code>環境スクリプトの読み込み</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>. admin-openrc
</code></pre></div></li><li><p>プロバイダネットワーク作成</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><ul><li><p>flat （untagged なごくごく普通の）ネットワークの場合</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack network create  --share --external --provider-physical-network provider --provider-network-type flat provider
</code></pre></div><ul><li><strong><code>--provider-physical-network provider</code>では<a href=https://aton-kish.github.io/blog/post/2020/09/16/openstack-ussuri-neutron/#neutron-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB>OpenStack Ussuriマニュアルインストールその６―Neutron編</a>の
<code>/etc/neutron/plugins/ml2/ml2_conf.ini</code>編集で設定したプロバイダネットワーク名を使用する</strong><ul><li>例えば、複数 NIC に対して<code>flat_networks = provider1,provider2,...</code>や<code>network_vlan_ranges = provider1:&lt;start Vlan ID>:&lt;end Vlan ID>,provider2:&lt;start Vlan ID>:&lt;end Vlan ID>,...</code>のように設定した場合は、<code>provider</code>ではなく<code>provider1</code>や<code>provider2</code>…を指定する</li></ul></li><li>最後の<code>provider</code>は作成するプロバイダネットワークの名前なので適宜変更してよい</li></ul></li><li><p>VLAN ネットワークの場合</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack network create  --share --external --provider-physical-network provider --provider-network-type vlan --provider-segment VLAN_ID provider
</code></pre></div><ul><li><strong><code>--provider-physical-network provider</code>では<a href=https://aton-kish.github.io/blog/post/2020/09/16/openstack-ussuri-neutron/#neutron-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB>OpenStack Ussuriマニュアルインストールその６―Neutron編</a>の
<code>/etc/neutron/plugins/ml2/ml2_conf.ini</code>編集で設定したプロバイダネットワーク名を使用する</strong><ul><li>例えば、複数 NIC に対して<code>flat_networks = provider1,provider2,...</code>や<code>network_vlan_ranges = provider1:&lt;start Vlan ID>:&lt;end Vlan ID>,provider2:&lt;start Vlan ID>:&lt;end Vlan ID>,...</code>のように設定した場合は、<code>provider</code>ではなく<code>provider1</code>や<code>provider2</code>…を指定する</li></ul></li><li><strong><code>VLAN_ID</code>は引き込みたい VLAN ID に書き換える</strong></li><li>最後の<code>provider</code>は作成するプロバイダネットワークの名前なので適宜変更してよい</li></ul></li><li><p>出力は以下の感じ</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+---------------------------+--------------------------------------+
| Field                     | Value                                |
+---------------------------+--------------------------------------+
| admin_state_up            | UP                                   |
| availability_zone_hints   |                                      |
| availability_zones        |                                      |
| created_at                | 2017-03-14T14:37:39Z                 |
| description               |                                      |
| dns_domain                | None                                 |
| id                        | 54adb94a-4dce-437f-a33b-e7e2e7648173 |
| ipv4_address_scope        | None                                 |
| ipv6_address_scope        | None                                 |
| is_default                | None                                 |
| mtu                       | <span style=color:#ae81ff>1500</span>                                 |
| name                      | provider                             |
| port_security_enabled     | True                                 |
| project_id                | 4c7f48f1da5b494faaa66713686a7707     |
| provider:network_type     | flat                                 |
| provider:physical_network | provider                             |
| provider:segmentation_id  | None                                 |
| qos_policy_id             | None                                 |
| revision_number           | <span style=color:#ae81ff>3</span>                                    |
| router:external           | External                             |
| segments                  | None                                 |
| shared                    | True                                 |
| status                    | ACTIVE                               |
| subnets                   |                                      |
| updated_at                | 2017-03-14T14:37:39Z                 |
+---------------------------+--------------------------------------+
</code></pre></div></li><li><p><code>--external</code>オプションは外部ネットワーク（プロバイダネットワーク）の作成</p></li><li><p><a href=https://aton-kish.github.io/blog/post/2020/09/16/openstack-ussuri-neutron/#neutron-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB>OpenStack Ussuriマニュアルインストールその６―Neutron編</a>で編集した
<code>/etc/neutron/plugins/ml2/ml2_conf.ini</code>の<code>[ml2_type_flat]</code>や<code>[ml2_type_vlan]</code>セクション、
<code>/etc/neutron/plugins/ml2/linuxbridge_agent.ini</code>の[linux_bridge]`セクションを読んで構成してくれるみたい</p></li></ul></li><li><p>サブネット作成</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack subnet create <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --network provider <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --allocation-pool start<span style=color:#f92672>=</span>PROVIDER_START_IP,end<span style=color:#f92672>=</span>PROVIDER_END_IP <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --dns-nameserver DNS_IP <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --gateway PROVIDER_GATEWAY_IP <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --subnet-range PROVIDER_SUBNET<span style=color:#f92672>(</span>CIDR<span style=color:#f92672>)</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    provider
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------------------+--------------------------------------+
| Field             | Value                                |
+-------------------+--------------------------------------+
| allocation_pools  | PROVIDER_START_IP-PROVIDER_END_IP    |
| cidr              | PROVIDER_SUBNET<span style=color:#f92672>(</span>CIDR<span style=color:#f92672>)</span>                |
| created_at        | 2017-03-29T05:48:29Z                 |
| description       |                                      |
| dns_nameservers   | DNS_IP                               |
| enable_dhcp       | True                                 |
| gateway_ip        | PROVIDER_GATEWAY_IP                  |
| host_routes       |                                      |
| id                | e84b4972-c7fc-4ce9-9742-fdc845196ac5 |
| ip_version        | <span style=color:#ae81ff>4</span>                                    |
| ipv6_address_mode | None                                 |
| ipv6_ra_mode      | None                                 |
| name              | provider                             |
| network_id        | 1f816a46-7c3f-4ccf-8bf3-fe0807ddff8d |
| project_id        | 496efd248b0c46d3b80de60a309177b5     |
| revision_number   | <span style=color:#ae81ff>2</span>                                    |
| segment_id        | None                                 |
| service_types     |                                      |
| subnetpool_id     | None                                 |
| updated_at        | 2017-03-29T05:48:29Z                 |
+-------------------+--------------------------------------+
</code></pre></div><ul><li><p>例えば、以下みたいな感じで作る</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack subnet create <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --network provider <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --allocation-pool start<span style=color:#f92672>=</span>172.16.100.1,end<span style=color:#f92672>=</span>172.16.100.255 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --dns-nameserver 1.1.1.1 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --gateway 172.16.0.1 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --subnet-range 172.16.0.0/16 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    provider
</code></pre></div></li><li><p><code>--allocation-pool</code>では OpenStack が適当に割り当ててくれるプロバイダネットワークの IP アドレスの範囲を指定</p></li><li><p><code>--dns-nameserver</code>は適当に好きなやつ</p></li></ul></li></ol><hr><h3 id=セルフサービスネットワーク>セルフサービスネットワーク</h3><p><a href=https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#create-the-self-service-network><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Self-service network - Create the self-service network</a><br><a href=https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#create-a-router><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Self-service network - Create a router</a></p><ol><li><p><code>myuser</code>環境スクリプトの読み込み</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>. demo-openrc
</code></pre></div><ul><li>当然<code>admin</code>プロジェクトに作ってもよいがドキュメントに倣う</li><li>セルフサービスネットワークはプロジェクトごとに作るのが普通だと思うので<code>admin</code>プロジェクト以外にも作成可能なことを確認する意味も込めて</li></ul></li><li><p>セルフサービスネットワーク作成</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack network create selfservice
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------------------------+--------------------------------------+
| Field                   | Value                                |
+-------------------------+--------------------------------------+
| admin_state_up          | UP                                   |
| availability_zone_hints |                                      |
| availability_zones      |                                      |
| created_at              | 2016-11-04T18:20:59Z                 |
| description             |                                      |
| headers                 |                                      |
| id                      | 7c6f9b37-76b4-463e-98d8-27e5686ed083 |
| ipv4_address_scope      | None                                 |
| ipv6_address_scope      | None                                 |
| mtu                     | <span style=color:#ae81ff>1450</span>                                 |
| name                    | selfservice                          |
| port_security_enabled   | True                                 |
| project_id              | 3828e7c22c5546e585f27b9eb5453788     |
| project_id              | 3828e7c22c5546e585f27b9eb5453788     |
| revision_number         | <span style=color:#ae81ff>3</span>                                    |
| router:external         | Internal                             |
| shared                  | False                                |
| status                  | ACTIVE                               |
| subnets                 |                                      |
| tags                    | <span style=color:#f92672>[]</span>                                   |
| updated_at              | 2016-11-04T18:20:59Z                 |
+-------------------------+--------------------------------------+
</code></pre></div><ul><li>最後の<code>selfservice</code>は作成するセルフサービスネットワークの名前なので適宜変更してよい</li><li><code>myuser</code>に強い権限がないのでオプションは原則指定できないらしい</li><li>自動的に<a href=https://aton-kish.github.io/blog/post/2020/09/16/openstack-ussuri-neutron/#neutron-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB>OpenStack Ussuriマニュアルインストールその６―Neutron編</a>で編集した
<code>/etc/neutron/plugins/ml2/ml2_conf.ini</code>の<code>[ml2]</code>や<code>[ml2_type_vxlan]</code>セクションを読んで構成してくれるらしい</li></ul></li><li><p>サブネット作成</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack subnet create <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --network selfservice <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --dns-nameserver DNS_IP <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --gateway SELF_SERVICE_GATEWAY_IP <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --subnet-range SELF_SERVICE_SUBNET<span style=color:#f92672>(</span>CIDR<span style=color:#f92672>)</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    selfservice
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------------------+-------------------------------------------+
| Field             | Value                                     |
+-------------------+-------------------------------------------+
| allocation_pools  | SELF_SERVICE_START_IP-SELF_SERVICE_END_IP |
| cidr              | SELF_SERVICE_SUBNET<span style=color:#f92672>(</span>CIDR<span style=color:#f92672>)</span>                 |
| created_at        | 2016-11-04T18:30:54Z                      |
| description       |                                           |
| dns_nameservers   | DNS_IP                                    |
| enable_dhcp       | True                                      |
| gateway_ip        | SELF_SERVICE_GATEWAY_IP                   |
| headers           |                                           |
| host_routes       |                                           |
| id                | 5c37348e-e7da-439b-8c23-2af47d93aee5      |
| ip_version        | <span style=color:#ae81ff>4</span>                                         |
| ipv6_address_mode | None                                      |
| ipv6_ra_mode      | None                                      |
| name              | selfservice                               |
| network_id        | b9273876-5946-4f02-a4da-838224a144e7      |
| project_id        | 3828e7c22c5546e585f27b9eb5453788          |
| project_id        | 3828e7c22c5546e585f27b9eb5453788          |
| revision_number   | <span style=color:#ae81ff>2</span>                                         |
| service_types     | <span style=color:#f92672>[]</span>                                        |
| subnetpool_id     | None                                      |
| updated_at        | 2016-11-04T18:30:54Z                      |
+-------------------+-------------------------------------------+
</code></pre></div><ul><li><p>例えば、以下みたいな感じで作る</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack subnet create <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --network selfservice <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --dns-nameserver 1.1.1.1 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --gateway 10.0.0.1 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --subnet-range 10.0.0.0/24 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    selfservice
</code></pre></div><ul><li><code>allocation_pools</code>は自動的に設定され、上の例では<code>10.0.0.2-10.0.0.254</code>とかになるはず</li></ul></li><li><p>内部（NAT 越しのプライベートな）ネットワークなので、サブネットはプロバイダネットワークのサブネットと重ならないように自由に決めていいと思う</p></li><li><p><code>--dns-nameserver</code>は適当に好きなやつ</p></li></ul></li><li><p>ルータ作成</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack router create router
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------------------------+--------------------------------------+
| Field                   | Value                                |
+-------------------------+--------------------------------------+
| admin_state_up          | UP                                   |
| availability_zone_hints |                                      |
| availability_zones      |                                      |
| created_at              | 2016-11-04T18:32:56Z                 |
| description             |                                      |
| external_gateway_info   | null                                 |
| flavor_id               | None                                 |
| headers                 |                                      |
| id                      | 67324374-396a-4db6-9443-c70be167a42b |
| name                    | router                               |
| project_id              | 3828e7c22c5546e585f27b9eb5453788     |
| project_id              | 3828e7c22c5546e585f27b9eb5453788     |
| revision_number         | <span style=color:#ae81ff>2</span>                                    |
| routes                  |                                      |
| status                  | ACTIVE                               |
| updated_at              | 2016-11-04T18:32:56Z                 |
+-------------------------+--------------------------------------+
</code></pre></div><ul><li>最後の<code>router</code>は作成するルータの名前なので適宜変更してよい</li><li>プロバイダネットワークとセルフサービスネットワークをつなぐためのルータ作成</li><li>通常は双方向 NAT の仮想ルータが用意される</li></ul></li><li><p>セルフサービスネットワークとルータを接続</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack router add subnet router selfservice
</code></pre></div></li><li><p>プロバイダネットワークとルータを接続</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack router set router --external-gateway provider
</code></pre></div></li></ol><hr><h3 id=動作確認>動作確認</h3><p><a href=https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#verify-operation><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Self-service network - Verify operation</a></p><ol><li><p><code>admin</code>環境スクリプトの読み込み</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>. admin-openrc
</code></pre></div></li><li><p>ネットワーク名前空間の一覧表示</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ip netns
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>qrouter-89dd2083-a160-4d75-ab3a-14239f01ea0b
qdhcp-7c6f9b37-76b4-463e-98d8-27e5686ed083
qdhcp-0e62efcd-8cee-46c7-b163-d8df05c3c5ad
</code></pre></div><ul><li><code>qrouter</code>1 つと<code>qdhcp</code>2 つがあるはず<ul><li>ルータ 1 つとネットワーク 2 つ（プロバイダとセルフサービスを 1 つずつ）作ったので</li></ul></li></ul></li><li><p>ルータのポート一覧表示</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack port list --router router
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+
| ID                                   | Name | MAC Address       | Fixed IP Addresses                                                            | Status |
+--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+
| bff6605d-824c-41f9-b744-21d128fc86e1 |      | fa:16:3e:2f:34:9b | ip_address<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;10.0.0.1&#39;</span>, subnet_id<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;3482f524-8bff-4871-80d4-5774c2730728&#39;</span>       | ACTIVE |
| d6fe98db-ae01-42b0-a860-37b1661f5950 |      | fa:16:3e:e8:c1:41 | ip_address<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;172.16.100.xxx&#39;</span>, subnet_id<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;5cc70da8-4ee7-4565-be53-b9c011fca011&#39;</span> | ACTIVE |
+--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+
</code></pre></div></li><li><p>ルータのプロバイダネットワーク側のゲートウェイ IP アドレス (<code>172.16.100.xxx</code>) への疎通確認<br>コントローラノードまたは<code>172.16.0.0/16</code>サブネット内の任意のホストから</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ping -c <span style=color:#ae81ff>4</span> 172.16.100.xxx
</code></pre></div></li></ol><hr><h2 id=フレーバー作成>フレーバー作成</h2><p><a href=https://docs.openstack.org/install-guide/launch-instance.html><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Launch an instance - Create m1.nano flavor</a></p><ul><li>フレーバーは VM インスタンスに割り与えるリソース（VCPU の数やメモリ、ディスクサイズなど）のテンプレート</li><li>Cirros 検証用の小さいフレーバーを用意しておくとよい</li></ul><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack flavor create --id <span style=color:#ae81ff>0</span> --vcpus <span style=color:#ae81ff>1</span> --ram <span style=color:#ae81ff>64</span> --disk <span style=color:#ae81ff>1</span> m1.nano
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+----------------------------+---------+
| Field                      | Value   |
+----------------------------+---------+
| OS-FLV-DISABLED:disabled   | False   |
| OS-FLV-EXT-DATA:ephemeral  | <span style=color:#ae81ff>0</span>       |
| disk                       | <span style=color:#ae81ff>1</span>       |
| id                         | <span style=color:#ae81ff>0</span>       |
| name                       | m1.nano |
| os-flavor-access:is_public | True    |
| properties                 |         |
| ram                        | <span style=color:#ae81ff>64</span>      |
| rxtx_factor                | 1.0     |
| swap                       |         |
| vcpus                      | <span style=color:#ae81ff>1</span>       |
+----------------------------+---------+
</code></pre></div><ul><li>最後の<code>m1.nano</code>は作成するフレーバーの名前なので適宜変更してよい</li><li>上記コマンドでは以下のテンプレートを<code>m1.nano</code>フレーバーとして作成している<table><thead><tr><th>Resource Name</th><th>Value</th></tr></thead><tbody><tr><td>VCPU</td><td>1</td></tr><tr><td>RAM</td><td>64M</td></tr><tr><td>Disk</td><td>1G</td></tr></tbody></table></li></ul><h3 id=フレーバー例>フレーバー例</h3><p><a href=https://docs.openstack.org/horizon/ussuri/admin/manage-flavors.html><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Manage flavors</a></p><ul><li><p>OpenStack Mitaka 以前はデフォルトでフレーバーが生成されていたらしい</p><table><thead><tr><th>Flavor</th><th>VCPU</th><th>RAM</th><th>Disk</th></tr></thead><tbody><tr><td>m1.tiny</td><td>1</td><td>512M</td><td>1G</td></tr><tr><td>m1.small</td><td>1</td><td>2048M</td><td>20G</td></tr><tr><td>m1.medium</td><td>2</td><td>4096M</td><td>40G</td></tr><tr><td>m1.large</td><td>4</td><td>8192M</td><td>80G</td></tr><tr><td>m1.xlarge</td><td>8</td><td>16384M</td><td>160G</td></tr></tbody></table></li><li><p>環境や使いたい OS にあわせて作りましょう</p></li></ul><hr><h2 id=ssh-鍵生成>SSH 鍵生成</h2><p><a href=https://docs.openstack.org/install-guide/launch-instance.html#generate-a-key-pair><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Launch an instance - Generate a key pair</a></p><ol><li><p><code>myuser</code>環境スクリプトの読み込み</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>. demo-openrc
</code></pre></div><ul><li>当然<code>admin</code>プロジェクトに作ってもよいがドキュメントに倣う</li><li>プロジェクトごとに違う SSH 鍵を作るのが普通だと思うので<code>admin</code>プロジェクト以外にも作成可能なことを確認する意味も込めて</li></ul></li><li><p>SSH 鍵生成・登録</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ssh-keygen -q -N <span style=color:#e6db74>&#34;&#34;</span>
openstack keypair create --public-key ~/.ssh/id_rsa.pub mykey
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------------+-------------------------------------------------+
| Field       | Value                                           |
+-------------+-------------------------------------------------+
| fingerprint | ee:3d:2e:97:d4:e2:6a:54:6d:0d:ce:43:39:2c:ba:4d |
| name        | mykey                                           |
| user_id     | 58126687cbcc4888bfa9ab73a2256f27                |
+-------------+-------------------------------------------------+
</code></pre></div><ul><li>最後の<code>mykey</code>は作成する鍵の名前なので適宜変更してよい</li><li>検証用にコントローラノードで鍵を生成しているが、当然自分が普段作っている鍵を登録してもよい</li><li><strong>というか自分の鍵を登録したほうがいいと思う</strong></li></ul></li><li><p>確認</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack keypair list
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------+-------------------------------------------------+
| Name  | Fingerprint                                     |
+-------+-------------------------------------------------+
| mykey | ee:3d:2e:97:d4:e2:6a:54:6d:0d:ce:43:39:2c:ba:4d |
+-------+-------------------------------------------------+
</code></pre></div></li></ol><hr><h2 id=セキュリティグループのルール>セキュリティグループのルール</h2><p><a href=https://docs.openstack.org/install-guide/launch-instance.html#add-security-group-rules><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Launch an instance - Add security group rules</a></p><ul><li><code>default</code>セキュリティグループではインスタンスへのリモートアクセスを拒否するようにファイアウォールが構成されている<ul><li><strong>なんらかのサービスを試して疎通が取れないときはここが原因のことが多い（個人の感想）</strong></li></ul></li><li>今回は ICMP、SSH だけ許可しておく</li><li>Web サーバとか試すなら http (80), https (443)をあけ忘れないように</li></ul><ol><li><p><code>myuser</code>環境スクリプトの読み込み</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>. demo-openrc
</code></pre></div><ul><li>当然<code>admin</code>プロジェクトに作ってもよいがドキュメントに倣う</li><li>プロジェクトごとに違うセキュリティグループのルールを作るのが普通だと思うので<code>admin</code>プロジェクト以外にも作成可能なことを確認する意味も込めて</li></ul></li><li><p>ICMP 許可</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack security group rule create --proto icmp default
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------------------+--------------------------------------+
| Field             | Value                                |
+-------------------+--------------------------------------+
| created_at        | 2017-03-30T00:46:43Z                 |
| description       |                                      |
| direction         | ingress                              |
| ether_type        | IPv4                                 |
| id                | 1946be19-54ab-4056-90fb-4ba606f19e66 |
| name              | None                                 |
| port_range_max    | None                                 |
| port_range_min    | None                                 |
| project_id        | 3f714c72aed7442681cbfa895f4a68d3     |
| protocol          | icmp                                 |
| remote_group_id   | None                                 |
| remote_ip_prefix  | 0.0.0.0/0                            |
| revision_number   | <span style=color:#ae81ff>1</span>                                    |
| security_group_id | 89ff5c84-e3d1-46bb-b149-e621689f0696 |
| updated_at        | 2017-03-30T00:46:43Z                 |
+-------------------+--------------------------------------+
</code></pre></div></li><li><p>SSH 許可</p><p><span class=label style=background-color:#3fbf3f><span class=overlay style=margin-right:2px>$</span>any user</span></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openstack security group rule create --proto tcp --dst-port <span style=color:#ae81ff>22</span> default
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>+-------------------+--------------------------------------+
| Field             | Value                                |
+-------------------+--------------------------------------+
| created_at        | 2017-03-30T00:43:35Z                 |
| description       |                                      |
| direction         | ingress                              |
| ether_type        | IPv4                                 |
| id                | 42bc2388-ae1a-4208-919b-10cf0f92bc1c |
| name              | None                                 |
| port_range_max    | <span style=color:#ae81ff>22</span>                                   |
| port_range_min    | <span style=color:#ae81ff>22</span>                                   |
| project_id        | 3f714c72aed7442681cbfa895f4a68d3     |
| protocol          | tcp                                  |
| remote_group_id   | None                                 |
| remote_ip_prefix  | 0.0.0.0/0                            |
| revision_number   | <span style=color:#ae81ff>1</span>                                    |
| security_group_id | 89ff5c84-e3d1-46bb-b149-e621689f0696 |
| updated_at        | 2017-03-30T00:43:35Z                 |
+-------------------+--------------------------------------+
</code></pre></div></li></ol><hr><h2 id=インスタンス起動>インスタンス起動</h2><p><a href=https://docs.openstack.org/install-guide/launch-instance-provider.html><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Launch an instance on the provider network</a><br><a href=https://docs.openstack.org/install-guide/launch-instance-selfservice.html><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Launch an instance on the self-service network</a><br><a href=https://docs.openstack.org/install-guide/launch-instance-cinder.html><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Block Storage</a><br><a href=https://docs.openstack.org/nova/ussuri/user/launch-instance-from-volume.html><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1rem" height="1rem" style="fill:currentColor"><path d="M432 320H4e2a16 16 0 00-16 16V448H64V128H208a16 16 0 0016-16V80a16 16 0 00-16-16H48A48 48 0 000 112V464a48 48 0 0048 48H4e2a48 48 0 0048-48V336a16 16 0 00-16-16zM488 0H360c-21.37.0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 000 34L157.67 377a24 24 0 0034 0L435.28 133.32 471 169c15 15 41 4.5 41-17V24A24 24 0 00488 0z"/></svg>OpenStack Docs: Launch an instance from a volume</a></p><ul><li>ドキュメントでは CLI ベースで書かれているが、Cinder ブロックストレージを有効化しているため CLI ベースでは結構コマンド数が多く面倒だったりする<ul><li>CLI ベースで試すとしたら<a href=https://docs.openstack.org/nova/ussuri/user/launch-instance-from-volume.html>OpenStack Docs: Launch an instance from a volume</a>がいいか…？</li></ul></li><li>簡単に試すために Horizon ダッシュボードからポチポチやりましょう<ol><li>Horizon ダッシュボードに<code>myuser</code>ユーザでログイン</li><li>プロバイダネットワーク、セルフサービスネットワーク上に Cirros VM を<code>m1.nano</code>フレーバーで建てる</li></ol></li></ul><h3 id=確認事項例>確認事項例</h3><ul><li>インスタンスのコンソールから VM にログインして内部から外に向けて ping 疎通ができること</li><li>インスタンスに外部から ping 疎通、SSH 接続ができること<ul><li><strong>セルフサービスネットワーク上の VM インスタンスには floating IP を設定することでプロバイダネットワークから ping や SSH が通るようになる</strong></li></ul></li></ul><hr><h2 id=おわり>おわり</h2><p>以上で起動編終了です<br>構築と簡単な起動テストは完了したので、あとは自由に試してみてください<br>お疲れ様でした</p><h3 id=関連記事一覧>関連記事一覧</h3><ul><li><a href=https://aton-kish.github.io/blog/post/2020/09/11/openstack-ussuri-installation/>OpenStack Ussuriをマニュアルインストールしてみたメモ</a><ol><li><a href=https://aton-kish.github.io/blog/post/2020/09/12/openstack-ussuri-environment/>OpenStack Ussuriマニュアルインストールその１―環境構築編</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/09/13/openstack-ussuri-keystone/>OpenStack Ussuriマニュアルインストールその２―Keystone編</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/09/14/openstack-ussuri-glance/>OpenStack Ussuriマニュアルインストールその３―Glance編</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/09/15/openstack-ussuri-placement/>OpenStack Ussuriマニュアルインストールその４―Placement編</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/09/15/openstack-ussuri-nova/>OpenStack Ussuriマニュアルインストールその５―Nova編</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/09/16/openstack-ussuri-neutron/>OpenStack Ussuriマニュアルインストールその６―Neutron編</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/09/17/openstack-ussuri-horizon/>OpenStack Ussuriマニュアルインストールその７―Horizon編</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/09/18/openstack-ussuri-cinder/>OpenStack Ussuriマニュアルインストールその８―Cinder編</a></li><li>OpenStack Ussuriマニュアルインストールその９―起動編（当記事）</li><li><a href=https://aton-kish.github.io/blog/post/2021/02/13/openstack-ussuri-octavia/>OpenStack Ussuri 追加インストールその１―Octavia編</a></li></ol></li><li><a href=https://aton-kish.github.io/blog/post/2021/03/14/openstack-victoria-installation/>OpenStack Victoriaをマニュアルインストールしてみたメモ</a></li><li><a href=https://aton-kish.github.io/blog/post/2020/11/27/openstack-tips/>OpenStack Tips</a></li><li>Issues<ol><li><a href=https://aton-kish.github.io/blog/post/2021/03/15/openstack-issue-ebtables/>Openstack Issueその１―正常に見えるのに大量にネットワークエラーが…</a></li><li><a href=https://aton-kish.github.io/blog/post/2021/03/15/openstack-issue-ipv6/>Openstack Issueその２―VMと疎通がとれない…</a></li><li><a href=https://aton-kish.github.io/blog/post/2021/03/15/openstack-issue-nonadmin-horizon/>Openstack Issueその３―Horizon「どこかがおかしくなりました」</a></li><li><a href=https://aton-kish.github.io/blog/post/2021/03/15/openstack-issue-selfservice-mtu/>Openstack Issueその４―セルフサービスネットワーク激遅問題（検証段階）</a></li></ol></li></ul></article></div></div></div></div></main></div></div><div class="footer container-lg width-full p-responsive" role=contentinfo><div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"><ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0"><li class="mr-3 mr-lg-0">© 2020 Aton-Kish</a></li></ul><a aria-label=Homepage title=Nota class="footer-octicon d-none d-lg-block mx-lg-4" href=https://aton-kish.github.io/blog/><svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0"></ul></div><div class="d-flex flex-justify-center pb-6"><span class="f6 text-gray-light"></span></div></div><script crossorigin=anonymous type=application/javascript src=https://aton-kish.github.io/blog/js/frameworks.js></script><script crossorigin=anonymous type=application/javascript src=https://aton-kish.github.io/blog/js/github-bootstrap.js></script><script src=https://aton-kish.github.io/blog/js/stop.js></script><script src=https://aton-kish.github.io/blog/js/contributions.js></script></body></html>